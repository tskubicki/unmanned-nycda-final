<%= javascript_include_tag "https://www.google.com/jsapi", "chartkick" %>

<% if @user.avatar %>
	<%= image_tag @user.avatar.url(:thumb) %><br>
<% end %>
<%= @user.username %> is logged in
<br>
<% if user_signed_in? %>
  <li>
  <%= link_to('Logout', destroy_user_session_path, :method => :delete) %>  
  </li>
<% else %>
  <li>
  <%= link_to('Login', new_user_session_path)  %>  
  </li>
<% end %>

<h3> <%= link_to('Leaderboard', '/game/leaderboard') %> </h3>
<h3> <%= link_to('Edit profile', edit_user_registration_path) %></h3>

<h2>Your score: <%= @user.total %> </h2>

<a href="/game/play">Play a new game</a><br>
<% if @user_games %>
	<h2>Your last game: </h2>
	<div class="last-game">
		<div style="background-color:lightgrey" class="game-entry">
			<div class="game-data">
				<p>Game ID: <%= @last_game.id %> </p>
				<p>Date: <%= @last_game.created_at %> </p>
				<p>Game length: <%= number_with_precision(@last_game.game_time, precision: 2) %> seconds </p>
				<p>Score: <%= number_with_precision(@last_game.score, precision: 0) %> </p>
				<p>Damage Taken: <%= number_with_precision(@last_game.damage_taken, precision: 0) %> </p>
				<p>Damage Inflicted: <%= number_with_precision(@last_game.damage_inflicted, precision: 0) %> </p>
				<div class="weapon-use-chart" style="width:500px;height:250px;display:inline-block">
					<%= pie_chart({
						"Laser" => number_with_precision(@last_game.laser_time, precision: 0),
						"Super Laser" => number_with_precision(@last_game.slaser_time, precision: 0),
						"Machine Gun" => number_with_precision(@last_game.mg_time, precision: 0)
					}, library: {title: "Primary Weapon Use"}) %>
				</div>
				<div class="weapon-use-chart" style="width:500px;height:250px;display:inline-block">
					<%= pie_chart({
						"HE Rocket" => number_with_precision(@last_game.rocket_time, precision: 0),
						"Mine" => number_with_precision(@last_game.mine_time, precision: 0),
					}, library: {title: "Secondary Weapon Use"}) %>
				</div>
			</div>
			<div class="clearfix" style="display:block;clear:both;visibility:none">.</div>
		</div>
	</div>
<h2>Recent Games</h2>
<div class="recent-games" > <!-- style="display:block;width:800px;height:450px; overflow: scroll;"-->
	<% @user_games.offset(1).each do |game|%>
		<div style="background-color:lightgrey" class="game-entry"> <!-- ;display:inline-block;float:left;margin:1%-->
			<div class="game-data">
				<p>Game ID: <%= game.id %> </p>
				<p>Date: <%= game.created_at %> </p>
				<p>Game length: <%= number_with_precision(game.game_time, precision: 2) %> seconds </p>
				<p>Score: <%= number_with_precision(game.score, precision: 0) %> </p>
				<p>Damage Taken: <%= number_with_precision(game.damage_taken, precision: 0) %> </p>
				<p>Damage Inflicted: <%= number_with_precision(game.damage_inflicted, precision: 0) %> </p>
				<div class="weapon-use-chart" style="width:500px;height:250px;display:inline-block">
					<%= pie_chart({
						"Laser" => number_with_precision(game.laser_time, precision: 0),
						"Super Laser" => number_with_precision(game.slaser_time, precision: 0),
						"Machine Gun" => number_with_precision(game.mg_time, precision: 0)
					}, library: {title: "Primary Weapon Use"}) %>
				</div>
				<div class="weapon-use-chart" style="width:500px;height:250px;display:inline-block">
					<%= pie_chart({
						"HE Rocket" => number_with_precision(game.rocket_time, precision: 0),
						"Mine" => number_with_precision(game.mine_time, precision: 0),
					}, library: {title: "Secondary Weapon Use"}) %>
				</div>
			</div>
			<div class="clearfix" style="display:block;clear:both;visibility:none">.</div>
		</div>
	<% end %>
</div>
<% else %>
	<p> You havent played any games yet. Click on the instant action button to begin! </p>
<% end %>

<div class="friends-list" >
	<h2>Friends</h2>
	<% @friends.each do |f| %>
		<p>
		  <%= image_tag f.avatar.url(:thumb) %> 
		  <%= f.username %>
		  <%= link_to "Profile", user_path(f.id) %>
		</p>
	<% end %>
</div>